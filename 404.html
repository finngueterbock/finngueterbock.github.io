<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>404 - page not found</title>
<link rel="stylesheet" href="style.css">
<link rel="icon" type="image/png" href="images/coin.png">

<style>
    body {
        margin: 0;
        padding: 0;
        overflow: hidden;
    }

    .scene-bg {
        width: 100%;
        height: 100vh;
        object-fit: cover;
        display: block;
    }

    #moon-phase {
        position: absolute;
        top: 20%;
        left: 50%;
        transform: translateX(-50%);
        text-align: center;
        color: white;
        font-size: 1.2rem;
        opacity: 0.9;
        font-family: 'Courier New', Courier, monospace;
        text-transform: lowercase;

        background: rgba(0, 0, 0, 0.45);
        padding: 10px 20px;
        border-radius: 12px;
        backdrop-filter: blur(4px);
        width: auto;
        max-width: 80%;
        display: inline-block;
    }

    .scene-wrapper {
        position: relative;
        width: 100%;
        height: 100vh;
    }

    .back-btn img {
        width: 60px;
        position: absolute;
        top: 20px;
        left: 20px;
        cursor: pointer;
    }
</style>
</head>

<body>

<a href="javascript:history.back()" class="back-btn">
    <img src="images/back.png" alt="Back">
</a>

<div class="scene-wrapper">

    <img src="images/404_bg.png" class="scene-bg" alt="404 Background">

    <img src="images/404.png" alt="404 bloke"
         style="position: absolute; bottom: 0; left: 10%; width: 45%;">

    <img src="images/not_found.png" alt="404 words"
         style="position: absolute; bottom: 40%; right: 3%; width: 50%;">

    <div id="moon-phase"></div>

</div>

<script>
// ---- Accurate Moon Phase Algorithm (Meeus-based) ----
function getMoonPhase() {
    const now = new Date();

    // Convert to Julian date
    const time = now.getTime() / 86400000 + 2440587.5;
    const T = (time - 2451545.0) / 36525;

    // Sun ecliptic longitude
    const L0 = (280.46646 + 36000.76983 * T) % 360;
    const M = (357.52911 + 35999.05029 * T) % 360;
    const lambdaSun = L0 + 1.914602 * Math.sin(M * Math.PI/180);

    // Moon calculations
    const L1 = (218.316 + 481267.8813 * T) % 360;
    const M1 = (134.963 + 477198.8676 * T) % 360;
    const D = (297.850 + 445267.1115 * T) % 360;

    const lambdaMoon = L1 + 6.289 * Math.sin(M1 * Math.PI/180);
    const phaseAngle = lambdaMoon - lambdaSun;

    // % Illumination
    const illumination = (1 - Math.cos(phaseAngle * Math.PI/180)) / 2;
    const pct = Math.round(illumination * 100);

    // Phase naming logic
    let phaseName = "";

    if (pct < 2) phaseName = "new moon ðŸŒ‘";
    else if (pct < 25) phaseName = "waxing crescent ðŸŒ’";
    else if (pct < 50) phaseName = "first quarter ðŸŒ“";
    else if (pct < 75) phaseName = "waxing gibbous ðŸŒ”";
    else if (pct < 98) phaseName = "full moon ðŸŒ•";
    else if (pct < 75) phaseName = "waning gibbous ðŸŒ–"; // safeguard
    else if (pct < 50) phaseName = "last quarter ðŸŒ—";
    else phaseName = "waning crescent ðŸŒ˜";

    return `current moon: ${phaseName} (${pct}% lit)`;
}

document.getElementById('moon-phase').innerText = getMoonPhase();
</script>

</body>
</html>
